<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í¬ë¦½í†  ê°€ê²© ì˜ˆì¸¡ ëŒ€ì‹œë³´ë“œ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-root: #050507;
            --bg-card: #0c0c10;
            --bg-card-hover: #111116;
            --border: #1a1a22;
            --border-light: #24242e;
            --text-primary: #eeeef0;
            --text-secondary: #7a7a8a;
            --text-muted: #4a4a58;
            --accent-green: #00e68a;
            --accent-green-dim: rgba(0, 230, 138, 0.12);
            --accent-blue: #4d8eff;
            --accent-blue-dim: rgba(77, 142, 255, 0.12);
            --accent-orange: #ff8a4d;
            --accent-orange-dim: rgba(255, 138, 77, 0.12);
            --accent-red: #ff5252;
            --accent-red-dim: rgba(255, 82, 82, 0.12);
            --accent-purple: #a78bfa;
            --radius: 14px;
            --radius-sm: 8px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: var(--bg-root);
            color: var(--text-primary);
            font-family: 'Outfit', -apple-system, BlinkMacSystemFont, sans-serif;
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
        }

        .container {
            max-width: 1040px;
            margin: 0 auto;
            padding: 28px 20px 40px;
        }

        /* â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: 28px;
        }

        .header-left h1 {
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: -0.03em;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .header-left p {
            font-size: 0.82rem;
            color: var(--text-secondary);
            font-weight: 400;
        }

        .update-badge {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            color: var(--text-muted);
            background: var(--bg-card);
            border: 1px solid var(--border);
            padding: 6px 12px;
            border-radius: 20px;
            white-space: nowrap;
            margin-top: 4px;
        }

        /* â”€â”€ Asset Tabs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .asset-tabs {
            display: flex;
            gap: 6px;
            margin-bottom: 24px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 5px;
        }

        .asset-tab {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 16px;
            border-radius: 9px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-family: 'Outfit', sans-serif;
            font-size: 0.88rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .asset-tab:hover {
            color: var(--text-primary);
            background: rgba(255,255,255,0.03);
        }

        .asset-tab.active {
            background: var(--border-light);
            color: var(--text-primary);
            font-weight: 600;
        }

        .tab-price {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.78rem;
            font-weight: 500;
            opacity: 0.7;
        }

        .tab-symbol {
            font-weight: 700;
            letter-spacing: 0.02em;
        }

        /* â”€â”€ Range Overview â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .range-overview {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        @media (max-width: 680px) {
            .range-overview {
                grid-template-columns: 1fr;
            }
        }

        .range-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 18px 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .range-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .range-card:hover {
            border-color: var(--border-light);
            background: var(--bg-card-hover);
        }

        .range-card.active {
            border-color: var(--border-light);
        }

        .range-card.active::before {
            opacity: 1;
        }

        .range-card[data-tf="weekly"]::before { background: var(--accent-green); }
        .range-card[data-tf="monthly"]::before { background: var(--accent-blue); }
        .range-card[data-tf="yearly"]::before { background: var(--accent-orange); }

        .range-card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 14px;
        }

        .range-tf-label {
            font-size: 0.72rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }

        .range-card[data-tf="weekly"] .range-tf-label { color: var(--accent-green); }
        .range-card[data-tf="monthly"] .range-tf-label { color: var(--accent-blue); }
        .range-card[data-tf="yearly"] .range-tf-label { color: var(--accent-orange); }

        .range-period {
            font-size: 0.7rem;
            color: var(--text-muted);
            font-weight: 400;
        }

        /* Range bar visualization */
        .range-bar-container {
            position: relative;
            height: 32px;
            margin-bottom: 12px;
        }

        .range-bar-track {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--border);
            border-radius: 2px;
            transform: translateY(-50%);
        }

        .range-bar-fill {
            position: absolute;
            top: 50%;
            height: 5px;
            border-radius: 3px;
            transform: translateY(-50%);
            opacity: 0.6;
        }

        .range-card[data-tf="weekly"] .range-bar-fill { background: var(--accent-green); }
        .range-card[data-tf="monthly"] .range-bar-fill { background: var(--accent-blue); }
        .range-card[data-tf="yearly"] .range-bar-fill { background: var(--accent-orange); }

        .range-bar-current {
            position: absolute;
            top: 50%;
            width: 10px;
            height: 10px;
            background: var(--text-primary);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 2;
            box-shadow: 0 0 0 3px var(--bg-card);
        }

        .range-values {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
        }

        .range-val {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.82rem;
            font-weight: 500;
        }

        .range-val.low { color: var(--accent-red); }
        .range-val.high { color: var(--accent-green); }

        .range-val-label {
            font-size: 0.65rem;
            color: var(--text-muted);
            font-weight: 400;
            font-family: 'Outfit', sans-serif;
            margin-left: 4px;
        }

        .range-no-data {
            text-align: center;
            color: var(--text-muted);
            font-size: 0.8rem;
            padding: 20px 0;
        }

        /* â”€â”€ Chart Section â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .chart-section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 24px;
            margin-bottom: 20px;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .chart-title-group h3 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 3px;
        }

        .chart-title-group p {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .chart-legend {
            display: flex;
            gap: 16px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .legend-dot {
            width: 10px;
            height: 10px;
            border-radius: 3px;
        }

        .legend-dot.up { background: var(--accent-green); }
        .legend-dot.down { background: var(--accent-red); }

        .chart-canvas-wrap {
            height: 360px;
            position: relative;
        }

        @media (max-width: 640px) {
            .chart-canvas-wrap { height: 280px; }
        }

        /* â”€â”€ Timeframe Tabs (inside chart) â”€â”€â”€â”€ */
        .tf-tabs {
            display: flex;
            gap: 4px;
            background: var(--bg-root);
            border-radius: 8px;
            padding: 3px;
        }

        .tf-tab {
            padding: 6px 14px;
            border-radius: 6px;
            border: none;
            background: transparent;
            color: var(--text-muted);
            font-family: 'Outfit', sans-serif;
            font-size: 0.75rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .tf-tab:hover { color: var(--text-secondary); }
        .tf-tab.active {
            background: var(--border-light);
            color: var(--text-primary);
            font-weight: 600;
        }

        /* â”€â”€ Probability Table â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .prob-section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 24px;
            margin-bottom: 20px;
        }

        .prob-section h3 {
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .prob-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        @media (max-width: 640px) {
            .prob-grid { grid-template-columns: 1fr; }
        }

        .prob-col-title {
            font-size: 0.72rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .prob-col-title.up { color: var(--accent-green); }
        .prob-col-title.down { color: var(--accent-red); }

        .prob-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.03);
        }

        .prob-row:last-child { border-bottom: none; }

        .prob-price {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--text-primary);
        }

        .prob-bar-wrap {
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
            max-width: 180px;
        }

        .prob-bar-bg {
            flex: 1;
            height: 4px;
            background: var(--border);
            border-radius: 2px;
            overflow: hidden;
        }

        .prob-bar-fill {
            height: 100%;
            border-radius: 2px;
            transition: width 0.4s ease;
        }

        .prob-bar-fill.up { background: var(--accent-green); }
        .prob-bar-fill.down { background: var(--accent-red); }

        .prob-pct {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.72rem;
            color: var(--text-secondary);
            min-width: 38px;
            text-align: right;
        }

        /* â”€â”€ Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.72rem;
            color: var(--text-muted);
            padding-top: 4px;
        }

        .footer-source {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .polymarket-tag {
            background: var(--border);
            color: var(--text-secondary);
            padding: 3px 10px;
            border-radius: 4px;
            font-weight: 500;
            font-size: 0.68rem;
        }

        /* â”€â”€ Loading / Error â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .loading-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 80px 0;
            color: var(--text-muted);
            gap: 12px;
        }

        .spinner {
            width: 28px;
            height: 28px;
            border: 2px solid var(--border);
            border-top-color: var(--text-secondary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        /* â”€â”€ Animations â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(6px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.3s ease forwards;
        }

        /* â”€â”€ Mobile â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        @media (max-width: 480px) {
            .container { padding: 16px 12px 32px; }
            .header { flex-direction: column; gap: 8px; }
            .header-left h1 { font-size: 1.25rem; }
            .asset-tab { padding: 10px 8px; font-size: 0.8rem; }
            .tab-price { display: none; }
            .chart-section { padding: 16px; }
            .prob-section { padding: 16px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <h1>ğŸ”® í¬ë¦½í†  ê°€ê²© ì˜ˆì¸¡</h1>
                <p>Polymarket ì˜ˆì¸¡ ì‹œì¥ ê¸°ë°˜ Â· ì£¼ê°„ / ì›”ê°„ / ì—°ê°„ ì „ë§</p>
            </div>
            <div class="update-badge" id="updateBadge">--</div>
        </div>

        <!-- Asset Tabs -->
        <div class="asset-tabs" id="assetTabs">
            <button class="asset-tab active" data-asset="btc">
                <span class="tab-symbol">BTC</span>
                <span class="tab-price" id="tab-price-btc">--</span>
            </button>
            <button class="asset-tab" data-asset="eth">
                <span class="tab-symbol">ETH</span>
                <span class="tab-price" id="tab-price-eth">--</span>
            </button>
            <button class="asset-tab" data-asset="sol">
                <span class="tab-symbol">SOL</span>
                <span class="tab-price" id="tab-price-sol">--</span>
            </button>
        </div>

        <!-- Range Overview Cards -->
        <div class="range-overview" id="rangeOverview">
            <div class="range-card active" data-tf="weekly" onclick="selectTimeframe('weekly')">
                <div class="range-card-header">
                    <span class="range-tf-label">ì´ë²ˆ ì£¼</span>
                    <span class="range-period" id="range-period-weekly">--</span>
                </div>
                <div class="range-bar-container" id="range-bar-weekly"></div>
                <div class="range-values">
                    <span class="range-val low" id="range-low-weekly">--</span>
                    <span class="range-val high" id="range-high-weekly">--</span>
                </div>
            </div>
            <div class="range-card" data-tf="monthly" onclick="selectTimeframe('monthly')">
                <div class="range-card-header">
                    <span class="range-tf-label">ì´ë²ˆ ë‹¬</span>
                    <span class="range-period" id="range-period-monthly">--</span>
                </div>
                <div class="range-bar-container" id="range-bar-monthly"></div>
                <div class="range-values">
                    <span class="range-val low" id="range-low-monthly">--</span>
                    <span class="range-val high" id="range-high-monthly">--</span>
                </div>
            </div>
            <div class="range-card" data-tf="yearly" onclick="selectTimeframe('yearly')">
                <div class="range-card-header">
                    <span class="range-tf-label">ì—°ê°„</span>
                    <span class="range-period" id="range-period-yearly">--</span>
                </div>
                <div class="range-bar-container" id="range-bar-yearly"></div>
                <div class="range-values">
                    <span class="range-val low" id="range-low-yearly">--</span>
                    <span class="range-val high" id="range-high-yearly">--</span>
                </div>
            </div>
        </div>

        <!-- Chart -->
        <div class="chart-section">
            <div class="chart-header">
                <div class="chart-title-group">
                    <h3 id="chartTitle">ë„ë‹¬ í™•ë¥  ë¶„í¬</h3>
                    <p id="chartSubtitle">ê° ê°€ê²© ëª©í‘œì— ë„ë‹¬í•  í™•ë¥ </p>
                </div>
                <div style="display:flex; align-items:center; gap:16px;">
                    <div class="chart-legend">
                        <span class="legend-item"><span class="legend-dot up"></span>ìƒìŠ¹ â†‘</span>
                        <span class="legend-item"><span class="legend-dot down"></span>í•˜ë½ â†“</span>
                    </div>
                    <div class="tf-tabs" id="tfTabs">
                        <button class="tf-tab active" data-tf="weekly" onclick="selectTimeframe('weekly')">ì£¼ê°„</button>
                        <button class="tf-tab" data-tf="monthly" onclick="selectTimeframe('monthly')">ì›”ê°„</button>
                        <button class="tf-tab" data-tf="yearly" onclick="selectTimeframe('yearly')">ì—°ê°„</button>
                    </div>
                </div>
            </div>
            <div class="chart-canvas-wrap" id="chartWrap">
                <div class="loading-state">
                    <div class="spinner"></div>
                    <span>ë°ì´í„° ë¡œë”© ì¤‘...</span>
                </div>
            </div>
        </div>

        <!-- Probability Table -->
        <div class="prob-section" id="probSection">
            <h3 id="probTitle">ìƒì„¸ í™•ë¥  ë°ì´í„°</h3>
            <div class="prob-grid" id="probGrid"></div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <div class="footer-source">
                <span class="polymarket-tag">Polymarket</span>
                <span>ì˜ˆì¸¡ ì‹œì¥ ë°ì´í„° ê¸°ë°˜ Â· íˆ¬ì ì¡°ì–¸ ì•„ë‹˜</span>
            </div>
        </div>
    </div>

    <script>
        // â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        let DATA = null;
        let activeAsset = 'btc';
        let activeTimeframe = 'weekly';
        let chart = null;

        // Chart.js defaults
        Chart.defaults.color = '#4a4a58';
        Chart.defaults.borderColor = '#1a1a22';
        Chart.defaults.font.family = "'Outfit', sans-serif";

        // â”€â”€ Data Loading â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        async function loadData() {
            try {
                const resp = await fetch('data.json');
                if (!resp.ok) throw new Error('Data not found');
                DATA = await resp.json();
                initDashboard();
            } catch (e) {
                console.error(e);
                document.getElementById('chartWrap').innerHTML =
                    '<div class="loading-state"><span>âš ï¸ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</span></div>';
            }
        }

        function initDashboard() {
            // Update tab prices
            for (const [key, asset] of Object.entries(DATA.assets)) {
                const el = document.getElementById(`tab-price-${key}`);
                if (el) el.textContent = formatPrice(asset.current_price, key);
            }

            // Update timestamp
            if (DATA.last_updated) {
                const d = new Date(DATA.last_updated);
                const kst = new Date(d.getTime() + 9 * 60 * 60 * 1000);
                document.getElementById('updateBadge').textContent =
                    kst.toLocaleDateString('ko-KR', { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' }) + ' KST';
            }

            // Setup tab listeners
            document.querySelectorAll('.asset-tab').forEach(tab => {
                tab.addEventListener('click', () => selectAsset(tab.dataset.asset));
            });

            renderAll();
        }

        // â”€â”€ Asset & Timeframe Selection â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        function selectAsset(asset) {
            activeAsset = asset;
            document.querySelectorAll('.asset-tab').forEach(t => t.classList.toggle('active', t.dataset.asset === asset));
            renderAll();
        }

        function selectTimeframe(tf) {
            activeTimeframe = tf;
            document.querySelectorAll('.range-card').forEach(c => c.classList.toggle('active', c.dataset.tf === tf));
            document.querySelectorAll('.tf-tab').forEach(t => t.classList.toggle('active', t.dataset.tf === tf));
            renderChart();
            renderProbTable();
        }

        function renderAll() {
            renderRangeCards();
            renderChart();
            renderProbTable();
        }

        // â”€â”€ Format Helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        function formatPrice(val, assetKey) {
            if (val == null) return '--';
            if (assetKey === 'sol' || (assetKey !== 'btc' && val < 1000)) {
                return '$' + val.toLocaleString('en-US', { maximumFractionDigits: val < 10 ? 2 : 0 });
            }
            return '$' + val.toLocaleString('en-US', { maximumFractionDigits: 0 });
        }

        function formatPriceShort(val, assetKey) {
            if (val == null) return '--';
            if (assetKey === 'sol') return '$' + Math.round(val);
            if (assetKey === 'eth') {
                return val >= 10000 ? '$' + (val/1000).toFixed(1) + 'K' : '$' + val.toLocaleString('en-US', {maximumFractionDigits:0});
            }
            // BTC
            if (val >= 1000) return '$' + (val/1000).toFixed(val >= 100000 ? 0 : 1) + 'K';
            return '$' + val;
        }

        function getPeriodLabel(tf, assetData) {
            const tfData = assetData?.timeframes?.[tf];
            if (!tfData) return '--';
            if (tf === 'weekly') {
                // Extract just the date range
                const title = tfData.event_title || '';
                const match = title.match(/((?:January|February|March|April|May|June|July|August|September|October|November|December)\s+\d[\d\s\-â€“,]*\d)/i);
                return match ? match[1] : tfData.period || '--';
            }
            return tfData.period || '--';
        }

        // â”€â”€ Range Cards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        function renderRangeCards() {
            const asset = DATA.assets[activeAsset];
            if (!asset) return;

            ['weekly', 'monthly', 'yearly'].forEach(tf => {
                const tfData = asset.timeframes?.[tf];
                const periodEl = document.getElementById(`range-period-${tf}`);
                const lowEl = document.getElementById(`range-low-${tf}`);
                const highEl = document.getElementById(`range-high-${tf}`);
                const barEl = document.getElementById(`range-bar-${tf}`);

                if (!tfData) {
                    periodEl.textContent = '--';
                    lowEl.textContent = '--';
                    highEl.textContent = '--';
                    barEl.innerHTML = '<div class="range-no-data">ë°ì´í„° ì—†ìŒ</div>';
                    return;
                }

                periodEl.textContent = getPeriodLabel(tf, asset);
                lowEl.innerHTML = formatPrice(tfData.expected_low, activeAsset) + '<span class="range-val-label">ì˜ˆìƒ ì €ì </span>';
                highEl.innerHTML = formatPrice(tfData.expected_high, activeAsset) + '<span class="range-val-label">ì˜ˆìƒ ê³ ì </span>';

                // Build range bar
                renderRangeBar(barEl, tfData, asset.current_price, tf);
            });
        }

        function renderRangeBar(container, tfData, currentPrice, tf) {
            if (!tfData.expected_low || !tfData.expected_high) {
                container.innerHTML = '';
                return;
            }

            const low = tfData.expected_low;
            const high = tfData.expected_high;
            // Add some padding to the range for visualization
            const rangeMin = low * 0.92;
            const rangeMax = high * 1.08;
            const total = rangeMax - rangeMin;

            const fillLeft = ((low - rangeMin) / total * 100).toFixed(1);
            const fillRight = ((rangeMax - high) / total * 100).toFixed(1);
            const fillWidth = (100 - parseFloat(fillLeft) - parseFloat(fillRight)).toFixed(1);
            const currentPos = Math.min(100, Math.max(0, ((currentPrice - rangeMin) / total * 100))).toFixed(1);

            container.innerHTML = `
                <div class="range-bar-track"></div>
                <div class="range-bar-fill" style="left:${fillLeft}%; width:${fillWidth}%"></div>
                <div class="range-bar-current" style="left:${currentPos}%" title="í˜„ì¬ê°€ ${formatPrice(currentPrice, activeAsset)}"></div>
            `;
        }

        // â”€â”€ Chart â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        function renderChart() {
            const asset = DATA.assets[activeAsset];
            const tfData = asset?.timeframes?.[activeTimeframe];

            const wrap = document.getElementById('chartWrap');

            if (!tfData || (!tfData.upside.length && !tfData.downside.length)) {
                wrap.innerHTML = '<div class="loading-state"><span>ì´ ê¸°ê°„ì˜ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</span></div>';
                return;
            }

            wrap.innerHTML = '<canvas id="mainChart"></canvas>';
            const ctx = document.getElementById('mainChart').getContext('2d');

            // Combine data
            const allData = [
                ...tfData.downside.map(d => ({ ...d, dir: 'down' })),
                ...tfData.upside.map(d => ({ ...d, dir: 'up' }))
            ].sort((a, b) => a.price - b.price);

            const labels = allData.map(d => formatPriceShort(d.price, activeAsset));
            const probs = allData.map(d => d.probability);
            const greenColor = '#00e68a';
            const redColor = '#ff5252';
            const colors = allData.map(d => d.dir === 'up' ? greenColor : redColor);
            const bgColors = allData.map(d => d.dir === 'up' ? 'rgba(0,230,138,0.7)' : 'rgba(255,82,82,0.7)');

            // Current price line position - interpolate based on actual price
            const currentP = asset.current_price;
            const prices = allData.map(d => d.price);
            let linePos = 0;
            if (currentP <= prices[0]) {
                linePos = 0;
            } else if (currentP >= prices[prices.length - 1]) {
                linePos = prices.length - 1;
            } else {
                for (let i = 0; i < prices.length - 1; i++) {
                    if (currentP >= prices[i] && currentP <= prices[i + 1]) {
                        const ratio = (currentP - prices[i]) / (prices[i + 1] - prices[i]);
                        linePos = i + ratio;
                        break;
                    }
                }
            }

            // Timeframe accent
            const tfAccents = { weekly: '#00e68a', monthly: '#4d8eff', yearly: '#ff8a4d' };
            const accent = tfAccents[activeTimeframe] || '#00e68a';

            if (chart) chart.destroy();

            chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels,
                    datasets: [{
                        data: probs,
                        backgroundColor: bgColors,
                        borderColor: colors,
                        borderWidth: 1,
                        borderRadius: 4,
                        borderSkipped: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: { duration: 400, easing: 'easeOutQuart' },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: '#0c0c10',
                            titleColor: '#eeeef0',
                            bodyColor: '#eeeef0',
                            borderColor: '#24242e',
                            borderWidth: 1,
                            padding: 14,
                            cornerRadius: 8,
                            displayColors: false,
                            titleFont: { family: "'JetBrains Mono', monospace", size: 12, weight: 600 },
                            bodyFont: { family: "'Outfit', sans-serif", size: 12 },
                            callbacks: {
                                title: (items) => {
                                    const d = allData[items[0].dataIndex];
                                    const dir = d.dir === 'up' ? 'â†‘ ìƒìŠ¹' : 'â†“ í•˜ë½';
                                    return `${asset.symbol} ${formatPrice(d.price, activeAsset)} ${dir}`;
                                },
                                label: (item) => `ë„ë‹¬ í™•ë¥ : ${item.raw.toFixed(1)}%`
                            }
                        },
                        annotation: {
                            annotations: {
                                currentLine: {
                                    type: 'line',
                                    xMin: linePos,
                                    xMax: linePos,
                                    borderColor: 'rgba(238,238,240,0.5)',
                                    borderWidth: 1.5,
                                    borderDash: [5, 4],
                                    label: {
                                        display: true,
                                        content: 'í˜„ì¬ê°€ ' + formatPrice(asset.current_price, activeAsset),
                                        position: 'start',
                                        backgroundColor: 'rgba(238,238,240,0.9)',
                                        color: '#050507',
                                        font: { size: 10, weight: 600, family: "'Outfit', sans-serif" },
                                        padding: { x: 8, y: 4 },
                                        borderRadius: 4
                                    }
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { display: false },
                            ticks: {
                                font: { family: "'JetBrains Mono', monospace", size: 10 },
                                color: '#7a7a8a',
                                maxRotation: 45,
                                minRotation: 0
                            }
                        },
                        y: {
                            min: 0,
                            max: 100,
                            grid: { color: 'rgba(26,26,34,0.8)', drawBorder: false },
                            ticks: {
                                font: { family: "'JetBrains Mono', monospace", size: 10 },
                                color: '#4a4a58',
                                callback: v => v + '%',
                                stepSize: 25
                            }
                        }
                    }
                }
            });

            // Update titles
            const tfLabels = { weekly: 'ì£¼ê°„', monthly: 'ì›”ê°„', yearly: 'ì—°ê°„' };
            document.getElementById('chartTitle').textContent =
                `${asset.symbol} ${tfLabels[activeTimeframe]} ë„ë‹¬ í™•ë¥ `;
            document.getElementById('chartSubtitle').textContent =
                tfData.event_title || 'ê° ê°€ê²© ëª©í‘œì— ë„ë‹¬í•  í™•ë¥ ';
        }

        // â”€â”€ Probability Table â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        function renderProbTable() {
            const asset = DATA.assets[activeAsset];
            const tfData = asset?.timeframes?.[activeTimeframe];
            const grid = document.getElementById('probGrid');

            if (!tfData) {
                grid.innerHTML = '<div class="range-no-data" style="grid-column:1/-1">ë°ì´í„° ì—†ìŒ</div>';
                return;
            }

            const tfLabels = { weekly: 'ì£¼ê°„', monthly: 'ì›”ê°„', yearly: 'ì—°ê°„' };
            document.getElementById('probTitle').textContent =
                `${asset.symbol} ${tfLabels[activeTimeframe]} ìƒì„¸ í™•ë¥ `;

            let html = '';

            // Upside column
            html += '<div>';
            html += '<div class="prob-col-title up">â†‘ ìƒìŠ¹ ëª©í‘œ</div>';
            if (tfData.upside.length === 0) {
                html += '<div style="color:var(--text-muted);font-size:0.8rem;">ë°ì´í„° ì—†ìŒ</div>';
            } else {
                tfData.upside.forEach(d => {
                    html += `
                        <div class="prob-row">
                            <span class="prob-price">${formatPrice(d.price, activeAsset)}</span>
                            <div class="prob-bar-wrap">
                                <div class="prob-bar-bg"><div class="prob-bar-fill up" style="width:${d.probability}%"></div></div>
                                <span class="prob-pct">${d.probability.toFixed(1)}%</span>
                            </div>
                        </div>`;
                });
            }
            html += '</div>';

            // Downside column
            html += '<div>';
            html += '<div class="prob-col-title down">â†“ í•˜ë½ ëª©í‘œ</div>';
            if (tfData.downside.length === 0) {
                html += '<div style="color:var(--text-muted);font-size:0.8rem;">ë°ì´í„° ì—†ìŒ</div>';
            } else {
                // Show highest to lowest
                [...tfData.downside].reverse().forEach(d => {
                    html += `
                        <div class="prob-row">
                            <span class="prob-price">${formatPrice(d.price, activeAsset)}</span>
                            <div class="prob-bar-wrap">
                                <div class="prob-bar-bg"><div class="prob-bar-fill down" style="width:${d.probability}%"></div></div>
                                <span class="prob-pct">${d.probability.toFixed(1)}%</span>
                            </div>
                        </div>`;
                });
            }
            html += '</div>';

            grid.innerHTML = html;
        }

        // â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        loadData();
    </script>
</body>
</html>
